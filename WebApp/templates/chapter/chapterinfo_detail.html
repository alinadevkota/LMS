{% load static %}

<div class="outerDiv">

    <div class="col-md-6 col-sm-12 col xs-12">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="col-md-12 col-sm-12 col-xs-12 text-center">
                <h2 class="detailListHeader">Chapter {{ object.Chapter_No }}
                    : {{ object.Chapter_Name }} </h2></div>
                     <a class="btn-sm btn-success"
                       href="#" id="lecture-viewer">Lecture
                        Viewer &nbsp;</a>
                    
            {% if '/students' not in request.path %}
                <div class="col-md-12 col-sm-12 col-xs-12 text-center" id="buttons">
                    <a class="btn-sm btn-primary"
                       href="{% if '/teachers' in request.path %}
                /teachers{{ object.get_update_url }}
            {% else %}
                {{ object.get_update_url }}
            {% endif %}">Edit Chapter &nbsp;</a>
                    <a class="btn-sm btn-success"
                       href="{% url 'chapterpagebuilder' object.Lecture_Code.id object.id %}">Lecture
                        Builder &nbsp;</a>
                    <a class="btn-sm btn-danger" href="{{ object.get_delete_url }}">Delete Chapter</a>
                </div>
            {% endif %}
            <div class="col-md-12 col-sm-12 col-xs-12" id="tabs">
                <table class="table">
                    <tr>
                        <td>Summary</td>
                        <td>{{ object.Summary }}</td>
                    </tr>
                    <tr>
                        <td>Page Number</td>
                        <td>{{ object.Page_Num }}</td>
                    </tr>
                    <tr>
                        <td>Status</td>
                        <td>{{ object.Use_Flag }}</td>
                    </tr>
                    <tr>
                        <td>Register Agent</td>
                        <td>{{ object.Register_Agent }}</td>
                    </tr>
                    <tr>
                        <td>Lecture Code</td>
                        <td>{{ object.Lecture_Code }}</td>
                    </tr>
                    <tr>
                        <td>Pre Test Quiz</td>
                        <td>
                            <div class="btn-group" id="status" data-toggle="buttons">
                                <label class="btn btn-default btn-on-3 btn-sm active" id="ActiveButton">
                                    <input type="radio" value="1" name="multifeatured_module[module_id][status]"
                                           checked="checked">ON</label>
                                <label class="btn btn-default btn-off-3 btn-sm" id="ExpireButton">
                                    <input type="radio" value="0"
                                           name="multifeatured_module[module_id][status]">OFF</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Post Test Quiz</td>
                        <td>
                            <div class="btn-group" id="status" data-toggle="buttons">
                                <label class="btn btn-default btn-on-3 btn-sm active" id="ActiveButton">
                                    <input type="radio" value="1" name="multifeatured_module[module_id][status]"
                                           checked="checked">ON</label>
                                <label class="btn btn-default btn-off-3 btn-sm" id="ExpireButton">
                                    <input type="radio" value="0"
                                           name="multifeatured_module[module_id][status]">OFF</label>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <div class="col-md-6 col-sm-12 xol-xs-12">

        <div class="col-md-12 col-sm-12 col-xs-12 ">
            <div class="col-md-12 col-sm-12 col-xs-12 text-center">
                <h2 class="detailListHeader">Assignments</h2>
            </div>
            {% if '/students' not in request.path %}
                <div class="col-md-12 col-sm-12 col-xs-12 text-center" id="buttons">
                    <a class="btn-sm btn-success" href="{% if '/teachers' in request.path %}
                        {% url 'teacher_assignmentinfo_create' %}
                    {% else %}
                        {% url 'assignmentinfo_create' course=object.Lecture_Code.id chapter=object.pk %}
                    {% endif %}">Create new Assignment</a>
                </div>
            {% endif %}
        </div>
        <div class="col-md-12">
            <hr class="header_hr">
            {% for o in assignments %}
                <div class="col-md-12 col-sm-12 col-xs-12 leftborder"  style="margin-bottom: 5px;">
                    <div class="col-md-8 col-sm-8 col-xs-12">
                        <h5 style="padding-top: 3px; color: #000000"> Assignment No: {{ forloop.counter }}</h5>
                        <h5>
                            <b style="color: #000000">{{ o.Assignment_Topic }}</b>
                        </h5>
                    </div>
                    <div class="col-md-4 col-sm-4 col-xs-12">
                        <a href="{% if '/students' in request.path %}
                                {{ o.student_get_absolute_url }}
                            {% else %}
                               {{ o.get_absolute_url }}
                            {% endif %}">
                            <button type="button" style="float: right;width:100px;height:25px;border: 1px solid #017a9b;color:#017a9b;background-color: white;border-radius: 4px;
                                margin-top: 20px;margin-bottom: 10px;">CONTINUE <i class="fa fa-arrow-right"></i>
                            </button>
                        </a>
                    </div>

                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <hr style="margin-top: 1px; margin-bottom: 10px;">
                        <p>Submission Deadline - {{ o.Assignment_Deadline }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>

{# Modal for chapter view #}

<div class="model-to-preview">
    <!-- Trigger/Open The Modal -->
    
    <!-- The Modal -->
    <div id="modal-container" class="modal">

    </div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<style>
    .modal {
    display: none; /* Hidden by default */
   position: fixed; /* Stay in place */
   z-index: 3; /* Sit on top */
   left: 0;
   top: 0;
   width: 100%; /* Full width */
   height: 100%; /* Full height */
   overflow: auto; /* Enable scroll if needed */
   background-color: rgb(0,0,0); /* Fallback color */
   background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
 }
 
 /* Modal Content/Box */
 .modal-data {
   background-color: #fefefe;
   margin: 5% auto; /* 15% from the top and centered */
   padding: 20px;
   border: 1px solid #888;
   width: 80%; /* Could be more or less, depending on screen size */
   height:700px;
 }


 
/* The Close Button */
.close-btn {
   color: #aaa;
   float: right;
   font-size: 28px;
   font-weight: bold;
 }
 
 .close-btn:hover,
 .close-btn:focus {
   color: black;
   text-decoration: none;
   cursor: pointer;
 }
</style>
<script>
    $('#lecture-viewer').click(function(){
        $.ajax({
            type: "GET",
            url: "{% url 'chapterviewer' %}",  // URL to your view that serves new info
            data: {
                'chapterID': '{{ object.id }}'
            },
            success: function(response) {
                // $("#model-content").append(response.data.numberofpages);
                loaddata(response.data)
            },
            error: function(){
                console.log('Error in getting chapters')
            }
        });
    });

    // Get the modal
    var modal = document.getElementById("modal-container");

    // Get the button that opens the modal
    var btn = document.getElementById("lecture-viewer");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close-btn")[0];

    // When the user clicks on the button, open the modal 
    btn.onclick = function() {
    modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
    modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    function loaddata(data){    
        $.each(data.pages, function(key, value){
            $.each(value, function(count){

                // Create modal
                $('#modal-container').append(`
                        <!-- Trigger/Open The Modal -->
                        
                        <!-- The Modal -->
                        <div id="modal${key}" class="modal">

                            <!-- Modal content -->
                            <div class="modal-data" id="model-content">
                                <span class="close-btn">&times;</span>
                                <p></p>
                            </div>

                        </div>
                `)
                
                // -------------------------------
                // if(key == '1'){
                    $.each(value[count], function(div,div_value){
                        // if(div == 'textdiv'){
                            $.each(div_value, function(css, css_value){
                                console.log(css_value)
                                $('#modal'+key).append(css_value);
                            })
                        // }
                    });
                // }
            });
            
        });

    // $("#modal-content").append(htmlContent);
    }
</script>
